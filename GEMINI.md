# KIS 자동매매 GUI 프로그램

## 1. 프로젝트 개요

이 프로그램은 한국투자증권(KIS)에서 제공하는 Open Trading API를 활용하여 주식 정보를 조회하고, 향후 자동매매 기능까지 확장할 수 있는 기반을 제공하는 PyQt6 기반의 GUI 애플리케이션입니다.

`open-trading-api` 라이브러리를 참조하여 필요한 기능을 GUI 환경에서 쉽게 사용할 수 있도록 개발되었습니다.

## 2. 프로젝트 아키텍처

이 프로젝트는 향후 클라우드 서버 환경에서의 자동매매(Headless) 운영을 고려하여, 핵심 로직과 사용자 인터페이스(GUI)를 명확하게 분리하는 모듈식 구조로 설계되었습니다.

- **`core_logic.py` (핵심 로직)**: API 인증, 데이터 조회 등 모든 비즈니스 로직을 포함합니다. 이 모듈은 GUI와 완전히 독립적이므로, 서버 환경에서 단독으로 실행하여 자동매매 로직을 수행할 수 있습니다.
- **`main_gui.py` (GUI)**: 사용자에게 데이터를 보여주고 상호작용하는 뷰어(Viewer)의 역할을 합니다. 실제 데이터 처리는 `core_logic.py`에 요청하여 그 결과를 화면에 표시합니다.
- **`column_mappings.py` (설정)**: API가 반환하는 다소 복잡한 영문 컬럼명을 이해하기 쉬운 한글로 변환하기 위한 매핑 정보를 중앙에서 관리합니다.

이러한 구조 덕분에, 동일한 핵심 로직을 사용하여 서버에서는 자동매매를, PC에서는 GUI를 통한 모니터링을 동시에 수행할 수 있습니다.

## 3. 주요 기능

- **실시간 시세 조회**: 특정 종목(예: 삼성전자)의 현재 시세를 조회하여 표 형태로 표시합니다.
- **계좌 잔고 조회**: 보유 주식 현황과 계좌의 종합 평가 현황을 별도의 탭에 나누어 표 형태로 조회합니다.
- **탭 기반 인터페이스**: 각 조회 결과를 별도의 탭으로 분리하여 가독성과 사용성을 높였습니다.
- **동적 컬럼 선택**: 각 표(그리드)마다 표시하고 싶은 정보(컬럼)를 사용자가 직접 선택할 수 있습니다.
- **한글화**: API에서 반환되는 영문 컬럼명을 이해하기 쉬운 한글로 변환하여 표시합니다.

## 4. 사전 준비 사항

- **Python**: Python 3.9 이상이 설치되어 있어야 합니다.
- **한국투자증권 Open API**: API 사용을 위한 App Key, App Secret 및 거래 계좌가 발급되어 있어야 합니다.

## 5. 설치 및 설정 방법

**1단계: 소스 코드 복제**

먼저, 한국투자증권 Open API 라이브러리 소스 코드를 복제합니다.

```bash
git clone https://github.com/koreainvestment/open-trading-api.git
```

**2단계: 필요 라이브러리 설치**

프로젝트의 루트 디렉토리(`trade_stock`)에서 아래 명령어를 실행하여 필요한 Python 라이브러리를 설치합니다.

```bash
cd open-trading-api
py -m pip install -r requirements.txt
cd ..
```

**3단계: 설정 파일(`kis_devlp.yaml`) 생성 및 수정**

API 호출에 필요한 인증 정보를 담는 설정 파일을 생성하고 수정해야 합니다.

1.  **폴더 생성**: 아래 경로에 `KIS\config` 폴더를 생성합니다.
    -   경로: `C:\Users\<사용자이름>\KIS\config` (여기서 `<사용자이름>`은 본인의 Windows 사용자 이름입니다.)

2.  **설정 파일 준비**: `open-trading-api` 폴더 안에 있는 `kis_devlp.yaml` 파일을 열어 본인의 정보를 입력합니다.

    ```yaml
    # 실전투자
    my_app: "여기에 실전투자 앱키 입력"
    my_sec: "여기에 실전투자 앱시크릿 입력"

    # HTS ID(KIS Developers 고객 ID)
    my_htsid: "사용자 HTS ID"

    # 계좌번호 앞 8자리
    my_acct_stock: "증권계좌 8자리"

    # 계좌번호 뒤 2자리
    my_prod: "01" # 종합계좌
    ```

3.  **설정 파일 복사**: 수정한 `kis_devlp.yaml` 파일을 위에서 생성한 `C:\Users\<사용자이름>\KIS\config` 폴더 안으로 복사합니다.

## 6. 프로그램 실행 방법

프로젝트의 루트 디렉토리(`trade_stock`)에서 아래 명령어를 실행하여 GUI 프로그램을 시작합니다.

```bash
py main_gui.py
```

프로그램이 실행되면 "현재가 조회", "계좌 잔고 조회" 등의 버튼을 클릭하여 기능을 테스트할 수 있습니다.

## 7. 파일 구조

```
C:\DigitalTwin\trade_stock
├── main_gui.py             # 메인 GUI 애플리케이션 (뷰어)
├── core_logic.py           # 핵심 비즈니스 로직 (API 호출, 데이터 처리)
├── column_mappings.py      # 컬럼명 한글 매핑 정보
├── open-trading-api/       # 한국투자증권 API 라이브러리 (원본)
├── test_balance.py         # 잔고 조회 기능 테스트용 스크립트
└── GEMINI.md               # 본 프로젝트 지침서
```